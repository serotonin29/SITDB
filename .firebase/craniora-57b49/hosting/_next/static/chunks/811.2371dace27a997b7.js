"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[811],{2811:function(t,e,r){r.r(e),r.d(e,{LocationPicker:function(){return c},default:function(){return u}});var n=r(7437),a=r(2265),l=r(759),o=r.n(l);let i=(0,r(9205).Z)("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);var s=r(3774);function c(t){let{value:e,onChange:r,className:l="h-[300px]"}=t,c=(0,a.useRef)(null),u=(0,a.useRef)(null),d=(0,a.useRef)(null),[g,p]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(!c.current||u.current)return;let t=e?[e.lat,e.lng]:[-6.2088,106.8456],n=o().map(c.current).setView(t,13);o().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}).addTo(n);let a=o().icon({iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",iconRetinaUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});return e&&(d.current=o().marker([e.lat,e.lng],{icon:a,draggable:!0}).addTo(n),d.current.on("dragend",async()=>{var t;let e=null===(t=d.current)||void 0===t?void 0:t.getLatLng();if(e){let t=await m(e.lat,e.lng);r({lat:e.lat,lng:e.lng,address:t})}})),n.on("click",async t=>{let{lat:e,lng:l}=t.latlng;d.current?d.current.setLatLng([e,l]):(d.current=o().marker([e,l],{icon:a,draggable:!0}).addTo(n),d.current.on("dragend",async()=>{var t;let e=null===(t=d.current)||void 0===t?void 0:t.getLatLng();if(e){let t=await m(e.lat,e.lng);r({lat:e.lat,lng:e.lng,address:t})}}));let i=await m(e,l);r({lat:e,lng:l,address:i})}),u.current=n,()=>{u.current&&(u.current.remove(),u.current=null)}},[]),(0,a.useEffect)(()=>{e&&u.current&&d.current&&(d.current.setLatLng([e.lat,e.lng]),u.current.setView([e.lat,e.lng],15))},[e]);let m=async(t,e)=>{try{let r=await fetch("https://nominatim.openstreetmap.org/reverse?format=json&lat=".concat(t,"&lon=").concat(e,"&addressdetails=1"));return(await r.json()).display_name}catch(t){return}};return(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{ref:c,className:"rounded-lg border border-gray-300 ".concat(l)}),(0,n.jsx)("div",{className:"absolute top-3 right-3 z-[1000] flex flex-col gap-2",children:(0,n.jsx)("button",{type:"button",onClick:()=>{if(!navigator.geolocation){alert("Geolocation tidak didukung oleh browser Anda");return}p(!0),navigator.geolocation.getCurrentPosition(async t=>{let{latitude:e,longitude:n}=t.coords;if(u.current){u.current.setView([e,n],15);let t=o().icon({iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",iconRetinaUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});d.current?d.current.setLatLng([e,n]):d.current=o().marker([e,n],{icon:t,draggable:!0}).addTo(u.current)}let a=await m(e,n);r({lat:e,lng:n,address:a}),p(!1)},t=>{console.error("Error getting location:",t),alert("Gagal mendapatkan lokasi. Pastikan GPS aktif."),p(!1)},{enableHighAccuracy:!0})},disabled:g,className:"bg-white p-2 rounded-lg shadow-md hover:bg-gray-50 transition-colors disabled:opacity-50",title:"Gunakan lokasi saat ini",children:g?(0,n.jsx)("div",{className:"w-5 h-5 border-2 border-primary-500 border-t-transparent rounded-full animate-spin"}):(0,n.jsx)(i,{className:"w-5 h-5 text-primary-600"})})}),(0,n.jsxs)("div",{className:"absolute bottom-3 left-3 z-[1000] bg-white/90 backdrop-blur px-3 py-2 rounded-lg shadow-md text-sm text-gray-600",children:[(0,n.jsx)(s.Z,{className:"inline w-4 h-4 mr-1"}),e?(0,n.jsxs)("span",{children:[e.lat.toFixed(4),", ",e.lng.toFixed(4)]}):(0,n.jsx)("span",{children:"Klik peta untuk pilih lokasi"})]})]})}var u=c}}]);