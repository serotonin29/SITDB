(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[883],{3966:function(e,a,s){Promise.resolve().then(s.bind(s,744))},744:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return g}});var t=s(7437),l=s(605),r=s(2265),n=s(9376),i=s(166),c=s(1817);let d=(0,s(9205).Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);var o=s(2489),u=s(5053);let m=(0,i.default)(()=>Promise.all([s.e(212),s.e(703)]).then(s.bind(s,703)),{loadableGenerated:{webpack:()=>[703]},ssr:!1,loading:()=>(0,t.jsx)("div",{className:"h-full bg-gray-100 animate-pulse"})}),x=[{value:"",label:"Semua Jenis"},{value:"BANJIR",label:"Banjir"},{value:"GEMPA",label:"Gempa"},{value:"KEBAKARAN",label:"Kebakaran"},{value:"LONGSOR",label:"Longsor"},{value:"TSUNAMI",label:"Tsunami"},{value:"ANGIN_TOPAN",label:"Angin Topan"},{value:"KEKERINGAN",label:"Kekeringan"},{value:"LAINNYA",label:"Lainnya"}],h=[{value:"",label:"Semua Status"},{value:"PENDING",label:"Menunggu"},{value:"VERIFIED",label:"Terverifikasi"},{value:"IN_PROGRESS",label:"Ditangani"},{value:"RESOLVED",label:"Selesai"},{value:"REJECTED",label:"Ditolak"}];function g(){let{data:e,status:a}=(0,l.useSession)(),s=(0,n.useRouter)(),[i,g]=(0,r.useState)([]),[p,b]=(0,r.useState)(null),[v,y]=(0,r.useState)(!0),[N,f]=(0,r.useState)(!1),[j,w]=(0,r.useState)({type:"",status:""});(0,r.useEffect)(()=>{k()},[j]);let k=async()=>{try{let e=new URLSearchParams;e.set("limit","100"),j.type&&e.set("type",j.type),j.status&&e.set("status",j.status);let a=await fetch("/api/reports?".concat(e.toString())),s=await a.json();if(s.success){let e=s.data.map(e=>({id:e.id,latitude:e.latitude,longitude:e.longitude,type:e.type,severity:e.severity,status:e.status,title:e.title}));g(e)}}catch(e){console.error("Error fetching reports:",e)}finally{y(!1)}},E=async e=>{try{let a=await fetch("/api/reports/".concat(e)),s=await a.json();s.success&&b(s.data)}catch(e){console.error("Error fetching report:",e)}};return"loading"===a||v?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)(u.Navbar,{}),(0,t.jsx)("div",{className:"flex items-center justify-center h-[60vh]",children:(0,t.jsx)(c.Z,{className:"w-8 h-8 animate-spin text-primary-500"})})]}):(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[(0,t.jsx)(u.Navbar,{}),(0,t.jsxs)("main",{className:"flex-1 relative",children:[(0,t.jsx)("div",{className:"absolute inset-0",children:(0,t.jsx)(m,{markers:i,onMarkerClick:E,className:"h-full"})}),(0,t.jsxs)("button",{onClick:()=>f(!N),className:"absolute top-4 left-4 z-[1000] bg-white shadow-lg rounded-lg px-4 py-2 flex items-center gap-2 hover:bg-gray-50 transition-colors",children:[(0,t.jsx)(d,{className:"w-5 h-5"}),"Filter",(j.type||j.status)&&(0,t.jsx)("span",{className:"w-2 h-2 rounded-full bg-primary-500"})]}),N&&(0,t.jsxs)("div",{className:"absolute top-16 left-4 z-[1000] bg-white shadow-lg rounded-xl p-4 w-64",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:"Filter"}),(0,t.jsx)("button",{onClick:()=>f(!1),children:(0,t.jsx)(o.Z,{className:"w-5 h-5 text-gray-400"})})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Jenis Bencana"}),(0,t.jsx)("select",{value:j.type,onChange:e=>w(a=>({...a,type:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:x.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,t.jsx)("select",{value:j.status,onChange:e=>w(a=>({...a,status:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:h.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,t.jsx)("button",{onClick:()=>w({type:"",status:""}),className:"w-full text-sm text-primary-600 hover:text-primary-700",children:"Reset Filter"})]})]}),p&&(0,t.jsxs)("div",{className:"absolute bottom-4 left-4 right-4 md:left-auto md:right-4 md:w-96 z-[1000] bg-white shadow-lg rounded-xl p-4",children:[(0,t.jsx)("button",{onClick:()=>b(null),className:"absolute top-3 right-3",children:(0,t.jsx)(o.Z,{className:"w-5 h-5 text-gray-400 hover:text-gray-600"})}),(0,t.jsxs)("div",{className:"pr-8",children:[(0,t.jsx)("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:p.type.replace("_"," ")}),(0,t.jsx)("h3",{className:"font-semibold text-gray-900 mt-1",children:p.title}),(0,t.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2 mt-2",children:p.description}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-4",children:[(0,t.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat("KRITIS"===p.severity?"bg-red-100 text-red-800":"BERAT"===p.severity?"bg-orange-100 text-orange-800":"SEDANG"===p.severity?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:p.severity}),(0,t.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-800",children:p.status.replace("_"," ")})]}),(0,t.jsx)("button",{onClick:()=>s.push("/reports/".concat(p.id)),className:"w-full mt-4 bg-primary-500 hover:bg-primary-600 text-white py-2 rounded-lg font-medium transition-colors",children:"Lihat Detail"})]})]}),(0,t.jsxs)("div",{className:"absolute bottom-4 right-4 z-[1000] bg-white shadow-lg rounded-lg p-3 hidden md:block",children:[(0,t.jsx)("h4",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Legenda"}),(0,t.jsxs)("div",{className:"space-y-1 text-xs",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),(0,t.jsx)("span",{children:"Banjir"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500"}),(0,t.jsx)("span",{children:"Gempa"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full bg-orange-500"}),(0,t.jsx)("span",{children:"Kebakaran"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full bg-green-500"}),(0,t.jsx)("span",{children:"Longsor"})]})]})]}),(0,t.jsx)("div",{className:"absolute top-4 right-4 z-[1000] bg-white shadow-lg rounded-lg px-4 py-2",children:(0,t.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:[i.length," Laporan"]})})]})]})}}},function(e){e.O(0,[976,605,240,971,117,744],function(){return e(e.s=3966)}),_N_E=e.O()}]);